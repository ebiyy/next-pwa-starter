setup:
  supabase:
    description: Supabaseの初期セットアップ
    priority: 1
    status: completed
    steps:
      - name: install
        command: bun add -d supabase
        description: Supabase CLIのインストール
        status: completed
      
      - name: init
        command: supabase init
        description: プロジェクトの初期化
        status: completed
      
      - name: start
        command: supabase start
        description: ローカル環境の起動
        status: completed

development:
  local:
    description: ローカル開発環境の管理
    priority: 2
    status: completed
    steps:
      - name: start
        command: bun run db:start
        description: ローカルSupabaseの起動
        status: completed
      
      - name: stop
        command: bun run db:stop
        description: ローカルSupabaseの停止
        status: completed
      
      - name: reset
        command: bun run db:reset
        description: データベースのリセット
        status: completed
      
      - name: studio
        command: bun run db:studio
        url: http://localhost:54323
        description: ローカルStudio UIにアクセス
        status: completed

  types:
    description: 型定義の管理
    priority: 2
    status: completed
    steps:
      - name: generate
        command: supabase gen types typescript --local > src/types/supabase.ts
        description: ローカルスキーマから型定義を生成
        status: completed
      
      - name: generate-remote
        command: supabase gen types typescript --project-id $SUPABASE_PROJECT_ID > src/types/supabase.ts
        description: リモートスキーマから型定義を生成

database:
  migration:
    description: データベースマイグレーションの管理
    priority: 3
    status: completed
    last_checked: "2025/01/14 01:04"
    steps:
      - name: create
        command: supabase migration new {name}
        description: 新しいマイグレーションファイルの作成
        status: completed
      
      - name: push
        command: supabase db push
        description: マイグレーションの適用
        status: completed
      
      - name: reset
        command: supabase db reset
        description: データベースのリセットとマイグレーションの再適用
seed:
  description: シードデータの管理
  priority: 3
  status: completed
  last_checked: "2025/01/14 01:04"
    status: completed
    steps:
      - name: local
        command: supabase db reset --seed-file supabase/seed.local.sql
        description: ローカル環境へのシードデータ投入
        status: completed
      
      - name: staging
        command: psql $STAGING_DATABASE_URL -f supabase/seed.staging.sql
        description: ステージング環境へのシードデータ投入

deploy:
  description: 環境別のデプロイ管理
  priority: 4
  access_token: sbp_1ed401cb866bd6d6a2c61945edcdc4af2bf51a8a
  environments:
    staging:
      steps:
        - name: link
          command: supabase link --project-ref $STAGING_PROJECT_ID
          description: ステージングプロジェクトとのリンク
        
        - name: push
          command: supabase db push
          description: ステージング環境へのデプロイ
    
    production:
      steps:
        - name: link
          command: supabase link --project-ref xiwnydehiplcjgrcjjko
          description: 本番プロジェクトとのリンク
          note: "Project ID: xiwnydehiplcjgrcjjko"
        
        - name: push
          command: supabase db push
          description: 本番環境へのデプロイ

maintenance:
  description: メンテナンス作業
  priority: 5
  steps:
    - name: logs
      command: supabase logs
      description: ログの確認
    
    - name: status
      command: supabase status
      description: 環境の状態確認
    
    - name: backup
      command: pg_dump $DATABASE_URL > backup.sql
      description: データベースのバックアップ

ci:
  description: CI/CD設定
  priority: 5
  status: completed
  github-actions:
    - name: type-check
      file: .github/workflows/type-check.yml
      description: 型チェックワークフロー
      status: completed
    
    - name: deploy
      file: .github/workflows/supabase-deploy.yml
      description: デプロイワークフロー
      status: completed

environments:
  description: 環境変数の設定
  priority: 5
  status: completed
  structure:
    - environments/
      - development/
        - .env
        - supabase/config.toml
        status: completed
      - staging/
        - .env
        - supabase/config.toml
        status: completed
      - production/
        - .env
        - supabase/config.toml
        status: completed
  scripts:
    - name: env:dev
      command: bun run env:dev
      description: 開発環境の設定を適用
      status: completed
    
    - name: env:staging
      command: bun run env:staging
      description: ステージング環境の設定を適用
      status: completed
    
    - name: env:prod
      command: bun run env:prod
      description: 本番環境の設定を適用
      status: completed

verification:
  description: 動作確認
  priority: 6
  status: completed
  last_checked: "2025/01/14 01:04"
  steps:
    - name: environment-switch
      description: 環境変数の切り替え確認
      command: bun run env:dev
      status: completed
    
    - name: database
      description: Supabaseの起動確認
      command: bun run db:start
      status: completed
    
    - name: application
      description: アプリケーションの起動確認
      command: bun run dev
      status: completed
    
    - name: studio
      description: Supabase Studioの動作確認
      command: bun run db:studio
      status: completed